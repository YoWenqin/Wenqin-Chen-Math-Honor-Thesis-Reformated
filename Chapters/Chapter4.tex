% Chapter Template

\chapter{Density Matrices} % Main chapter title

\label{Chapter4-density matrix} % Change X to a consecutive number; for referencing this chapter elsewhere, use \ref{ChapterX}


In the last chapter we formulated the postulates of quantum mechanics using the language of state vectors. These could have been stated using \textit{density matrices} as well. 
{\color{green}
There are at least two motivations behind introducing density matrices. We have already seen that measurements yield different states with a probability distribution. The first motivation behind density matrices is to describe a quantum system whose state is probabilistic {\emph{even prior to measurement}}. You can imagine a source such as a machine that \emph{prepares} quantum states with a probability distribution. Thus with density matrices probability enters the discussion at another level altogether.
In addition, for entangled joint state vectors such as $\ket{EPR}$ (see \eqref{eqn: epr}), that cannot written as a simple tensor product between $\ket{a}$ and $\ket{b}$, it is unclear how to describe the state of $\ket{a}$ without any reference to $\ket{b}$. Therefore, the second motivation behind density matrices is to provide an effective mathematical generalization for describing such $\ket{a}$. 
}
% We have already seen that a {\emph{fixed}} state vector for a system gives rise to a probability distribution when it is measured.  Density matrices allow one to 
% describe a quantum system whose state is probabilistic {\emph{even prior to measurement}}.  Thus with density matrices probability enters the discussion at another level altogether.

This additional wrinkle is interesting, but is not used significantly in future chapters.  In the interest of completeness, we summarize some key ideas in the "density matrix" formulation.  The reader may choose to skip everything in the chapter after {\bf{Lemma}} \ref{lemma state into density}.

% \textcolor{red}{for most of what follows, we are only interested in pure states. maybe put the general definition in footnote.}
\begin{definition}
\textcolor{green}{Suppose a source prepares quantum states $\{\ket{\psi_1},\hdots,\ket{\psi_n}\}$ in a probabilistic manner, i.e. it prepares the quantum state $\ket{\psi}_i$ with probability $p_i$ with}
 \begin{equation}
\sum\limits_i^n p_i=1, p_i \geq 0,
\end{equation}
then the resulting density matrix is given by
\begin{equation}
    \rho:=\sum_i p_i \ket{\psi_i}\bra{\psi_i}.
\end{equation}
\textcolor{green}{The set of probabilities and states $\{(p_i, \ket{\psi_i})\}$ is called an \textit{ensemble} of states.}
% that a quantum system is in the state $\ket{\psi_i}$ with probability $p_i$, where  
% \begin{equation}
% \sum\limits_i^n p_i=1, p_i \geq 0.
% \end{equation}
% Then, we define the density matrix for the quantum system $\rho$, by 
% \begin{equation}
%     \rho:=\sum_i p_i \ket{\psi_i}\bra{\psi_i}.
% \end{equation}
\end{definition}
\bigskip

Note that density matrices can be viewed as generalizing state vectors.  Let $\ket{\psi}$ be a state vector and consider the assignment
$$\ket{\psi} \xrightarrow{\iota} \ket{\psi}\bra{\psi}.$$

Clearly, the matrix $\iota(\ket{\psi})=\ket{\psi}\bra{\psi}$ can be regarded as the density matrix for the system that is in the state $\ket{\psi}$ with probability $1$, i.e. the state vector $\ket{\psi}$. Notice $\iota({\ket{\psi}})$ is a rank-1 matrix with precisely 1 non-zero eigenvalue that is equal to 1 with associated eigenstate $\ket{\psi}$.
\textcolor{green}{We call such density matrix $\iota(\ket{\psi})$ a \textit{pure state}. More formally, we say a density matrix is a pure state if it is a one-dimensional projector. Otherwise, it is a \textit{mixed state}. We will only talk about pure states in this thesis.}
The following lemma shows that the function $\iota$ is an inclusion for our purposes.

\begin{lemma}
\label{lemma state into density}
Let $\ket{\psi_1}, \ket{\psi_2}$ be state vectors in ${\mathbb{C}}^n$ with $\iota({\ket{\psi_1}})=\iota(\ket{\psi_2})$.\\
Then $\ket{\psi_1}=\ket{\psi_2}$ up to a global phase.
\end{lemma}
\begin{proof}
Let $\ket{\psi_1}=\icol{a_1\\ \vdots \\ a_n}, \ket{\psi_2}=\icol{b_1\\ \vdots \\ b_n}$. Then
\begin{gather}
\iota({\ket{\psi_1}})=\iota(\ket{\psi_2})\\
\Rightarrow \begin{pmatrix}
a_1 \Bar{a_1} && a_1 \Bar{a_2} && \hdots && a_1 \Bar{a_n}\\
&& && \vdots && \\
a_n \Bar{a_1} && a_n \Bar{a_2} && \hdots && a_n \Bar{a_n}\\              
\end{pmatrix}=\begin{pmatrix}
b_1 \Bar{b_1} && b_1 \Bar{b_2} && \hdots && b_1 \Bar{b_n}\\
&& && \vdots && \\
b_n \Bar{b_1} && b_n \Bar{b_2} && \hdots && b_n \Bar{b_n}\\ 
\end{pmatrix}\\
\Rightarrow 
\begin{cases}
a_1 \Bar{a_1}=b_1 \Bar{b_1}\\
a_2 \Bar{a_2}=b_2 \Bar{b_2}\\
\hdots\\
a_n \Bar{a_n}=b_n \Bar{b_n}\\
a_1 \Bar{a_2}=b_1 \Bar{b_2}\\
\hdots
\end{cases}
\Rightarrow \begin{cases}
a_1 = e^{i\theta_1}b_1\\
\hdots\\
a_n = e^{i\theta_n}b_n\\
a_1 \Bar{a_2}=b_1 \Bar{b_2}\\
\hdots
\end{cases}
\Rightarrow \begin{cases}
e^{i\theta_1}b_1 e^{-i\theta_2}\Bar{b_2}=b_1 \Bar{b_2}\\
\hdots\\
\end{cases}\\
\Rightarrow \theta_1 = \theta_2 = \hdots = \theta_n
\Rightarrow\ket{\psi_1}=e^{i\theta_1}\ket{\psi_2}
\end{gather}
\end{proof}

Since state vectors can only be determined up to a global phase, from a quantum mechanics perspective, the map $\iota$ is one-ton-one, hence state vectors are a special case of density matrices. \textcolor{green}{We can therefore reformulate all the postulates introduced in the previous chapter in the language of density matrices. Here we just present the definition of measuring on a basis using density matrix. In other words, \textbf{Definition \ref{def: measurement in a basis state vector}} becomes the following:}


\begin{definition}[Measuring a Density Matrix in a Basis]
Consider a quantum system in a state in $\mathbb{C}^n$ represented by the density matrix $\rho$. Measuring $\rho$ in the basis $\{\ket{u_i}\}_{i=1}^n$ results in outcome $i$ with probability 
\begin{equation} \label{eqn: measurement probability in density matrix}
    q_i=\braket{u_i | \rho |u_i}
\end{equation}
\end{definition}

{\color{green}
The justification of \textbf{Definition \ref{eqn: measurement probability in density matrix}} and how density matrices reformulate the four postulates can be found in \textbf{Appendix \ref{AppendixB}}. Here we just present an example of measuring a density matrix in a basis.


\begin{example}
Consider a source that prepares the state $\ket{0}$ and $\ket{1}$ with probabilities $p_0=p_1=\frac{1}{2}$. Suppose we measure the resulting state
$$\rho=\frac{1}{2}\ket{0}\bra{0}+\ket{1}\bra{1}=\frac{\mathbb{I}}{2},$$
in the Hadamard basis $\{\ket{+}, \ket{-}\}$. The probabilities of the outcomes are given by 
\begin{gather}
    q_1=\braket{+|\rho|+}=\frac{1}{2}\\
    q_2=\braket{-|\rho|-}=\frac{1}{2}
\end{gather}
\end{example}
}

{\color{green}
How do we use density matrices to represent measurement on a subsystem? In other words, if Alice and Bob share a joint state in $\mathbb{C}^n \otimes \mathbb{C^n}$ represented by a density matrix $\rho$, and Alice makes a measurement with respect to an orthonormal basis $\{\ket{u_i}\}_{i=1^n}$, the corresponding measurement operator on the composite system in terms of density matrix is $$\ket{u_i}\bra{u_i} \otimes \mathbb{I}_n.$$ Intuitively this is reasonable because when Alice makes a measurement, Bob does nothing. Say Alice's measurement end state is $\ket{u_{i_0}}$, then Bob's measurement statistics (the probability of each outcome) should be the same as those before Alice's measurement. You can check that this is true using By \eqref{eqn: general measurement probability density matrix}.

Even though we will only discuss pure states, the reformulated postulates with density matrices apply to all mixed states. The first motivation behind density matrices (as introduced at the start of the chapter) is therefore addressed. The operation called \textit{partial trace} using density matrices is the key to address the second motivation, in which we want to answer the following question: suppose $\rho$ is a density matrix on a tensor product space $\mathbb{C}^{d_1} \otimes \mathbb{C}^{d_2}$, but suppose Alice holds the part of $\rho$ corresponding to system A and Bob holds the part corresponding to system B. How do we describe the state $\rho_A$ of Alice's system? A formal definition of partial trace and \textit{reduced density matrix} can be found in \textbf{Appendix \ref{AppendixB}}.
}



