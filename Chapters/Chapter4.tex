% Chapter Template

\chapter{Density Matrices} % Main chapter title

\label{Chapter4-density matrix} % Change X to a consecutive number; for referencing this chapter elsewhere, use \ref{ChapterX}

In the last chapter we formulated the postulates of quantum mechanics using the language of state vectors. These could have been stated using \textit{density matrices} as well. We have already seen that a {\emph{fixed}} state vector for a system gives rise to a probability distribution when it is measured.  Density matrices allows one to describe a quantum system whose state is probabilistic {\emph{even prior to measurement}}.  Thus with density matrices probability enters the discussion at another level altogether.

This additional wrinkle is very interesting, but is not used significantly in future chapters.  In the interest of completeness, we summarize some key ideas in the "density matrix" formulation.  The reader may choose to skip everything in the chapter after {\bf{Lemma}} \ref{lemma state into density}.

\begin{definition}
Let $\{\ket{\psi_1},\hdots,\ket{\psi_n}\}$ be states.  Suppose that a quantum system is in the state $\ket{\psi_i}$ with probability $p_i$, where  
\begin{equation}
\sum\limits_i^n p_i=1, p_i \geq 0.
\end{equation}
Then, we define the density matrix for the quantum system $\rho$, by 
\begin{equation}
    \rho:=\sum_i p_i \ket{\psi_i}\bra{\psi_i}.
\end{equation}
\end{definition}

Note that density matrices can be viewed as generalizing state vectors.  Let $\ket{\psi}$ be a state vector and consider the assignment
$$\ket{\psi} \xrightarrow{\iota} \ket{\psi}\bra{\psi}.$$

Clearly, the matrix $\ket{\psi}\bra{\psi}$ can be regarded as the density matrix for the system that is in the state $\ket{\psi}$ with probability $1$, i.e. the state vector $\ket{\psi}$.  The following Lemma shows that this function is an inclusion for our purposes.

********************************************

\begin{lemma}
\label{lemma state into density}
Let $\ket{\psi_1}, \ket{\psi_2}$ be state vectors in ${\mathbb{C}}^n$ with $\iota({\ket{\psi_1}})=\iota(\ket{\psi_2})$.\\
Then $\ket{\psi_1}=\ket{\psi_2}$ up to a global phase.
\end{lemma}
\begin{proof}
Insert proof
\end{proof}

*****************************************************

Since state vectors can only be determined up to a global phase, from a quantum mechanics perspective, the map $\iota$ is one-ton-one, hence state vectors are a special case of density matrices.  If we wish to emphasize that a state is given by a proper density matrix, we say the state is \textit{mixed}.  In similar fashion, states given by vectors are sometimes called {\emph{pure}}.  The material in this Chapter past this point will not be used in subsequent Chapters of the thesis, so the reader can freely skip ahead.


***************************************************************

The four Postulates from the preceding Chapter can be reworked with density matrices in place of state vectors. For example, here's \textbf{Postulate 2} reworked for density matrices:
\begin{quote}
    {\bf{Postulate 2'}}: Say the evolution of a closed quantum system is described by a unitary transformation U. Then the evolution of the density operator is described by the equation
    \begin{equation}
        \rho=\sum_i p_i \ket{\psi_i}\bra{\psi_i}	\underrightarrow{U}\sum_i p_i U \ket{\psi_i}\bra{\psi_i}U^\dagger=U \rho U^\dagger
    \end{equation}
\end{quote}

Note that this computation is consistent with Lemma \ref{lemma state into density} and {\bf{Postulate 2}} since
\begin{eqnarray}
\ket{U \psi_i}\bra{U \psi_i}&=& \ket{U \psi_i}(\ket{U \psi_i}^\dagger)\\
&=& \ket{U\psi_i}(\ket{\psi_i})^\dagger U^\dagger\\
&=& \ket{U \psi_i} \bra{\psi_i}U^\dagger\\
&=& U \ket{\psi_i}\bra{\psi_i}U^\dagger.
\end{eqnarray}

Similarly, (\textbf{Postulate 3}) can be translated to density matrices:
\begin{quote}
    {\bf{Postulate 3'}}: Suppose we perform a measurement described by measurement operators $M_m$ on an ensemble of pure states $\{p_i, \ket{\psi_i}\}$. If the initial state prepared was $\ket{\psi_i}$, then the probability of getting result m is
    \begin{equation}
        p(m|i)=\braket{\psi_i|M_m^\dagger M_m|\psi_i}=tr(\braket{\psi_i|M_m^\dagger M_m|\psi_i})=tr(M_m^\dagger M_m \ket{\psi_i}\bra{\psi_i})
    \end{equation}
    The post-measurement state given the initial state being $\ket{\psi_i}$ is
    \begin{equation}
        \ket{\psi_i^m}=\frac{M_m \ket{\psi_i}}{\sqrt{\bra{\psi_i}M_m^\dagger M_m \ket{\psi_i}}}
    \end{equation}
    So the probability of obtaining result m is
    \begin{equation}
        p(m)=\sum_i p(m|i)p_i=\sum_i p_i tr(M_m^\dagger M_m \ket{\psi_i}\bra{\psi_i})=tr(M_m^\dagger M_m \rho)
    \end{equation}
    The post-measurement state upon result m is an ensemble of states $\ket{\psi_i^m}$ with respective probabilities $p(i|m)$
    \begin{equation}
        \rho_m = \sum_i p(i|m)\ket{\psi_i^m}\bra{\psi_i^m}=\sum_i p(i|m)\frac{M_m \ket{\psi_i}\bra{\psi_i}M_m^\dagger}{\bra{\psi_i}M_m^\dagger M_m \ket{\psi_i}}
    \end{equation}
    By probability theory, we have $p(i|m)=\frac{p(m,i)}{p(m)}=\frac{p(m|i)p_i}{p(m)}$. So
    \begin{equation}
        \rho_m=\sum_i \frac{p(m|i)p_i}{p(m)}\frac{M_m \ket{\psi_i}\bra{\psi_i}M_m^\dagger}{\bra{\psi_i}M_m^\dagger M_m \ket{\psi_i}}=\frac{M_m M_m (\sum_i p_i \ket{\psi_i}\bra{\psi_i})M_m^\dagger}{p(m)}=\frac{M_m \rho M_m^\dagger}{tr(M_m^\dagger M_m \rho)}
    \end{equation}
\end{quote}



\textcolor{red}{add an example of density matrix with probability distribution and its outcome probability}.

\begin{theorem}[Characterization of density matrix]
A matrix $\rho$ is the density matrix associated to some ensemble $\{p_i, \ket{\psi_i}\}$ if and only if it satisfies the conditions:
\begin{enumerate}
    \item (\textbf{Trace condition}) $tr(\rho)=1$
    \item (\textbf{Positive condition}) $\rho$ is a positive matrix \footnote{Positive operators is a special subclass of Hermitian operators. A positive operator A is definined to be an operator such that for any vector $\ket{v}$, $\langle \ket{v}, A\ket{v} \rangle \in \mathbb{R}_{\ge 0}$. It turns out that any positive operator has diagonal representation $\sum_i \lambda_i \ket{i}\bra{i}$ with non-negative eigenvalues $\lambda_i$.} 
\end{enumerate}
\end{theorem}

\begin{proof}
Given a density matrix $\rho=\sum_i p_i \ket{\psi_i}\bra{\psi_i}$. Then
\begin{equation}
    tr(\rho)=\sum_i p_i tr(\ket{\psi_i}\bra{\psi_i})=\sum_i p_i =1
\end{equation}
So the trace condition is satisfied. Notice here from section \ref{section:complex vector space} we know all eigenvalues of a projector like $\ket{\psi_i}\bra{\psi_i}$ are 0 or 1. Since trace is equal to the sum of eigenvalues, we have $tr(\ket{\psi_i}\bra{\psi_i})=1$. Now suppose $\ket{\varphi}$ is an arbitrary vector in state space. Then
\begin{equation}
    \braket{\varphi|\rho|\varphi}=\sum_i p_i \braket{\varphi|\psi_i} \braket{\psi_i|\varphi}=\sum_i p_i |\braket{\varphi|\psi_i}|^2 \ge 0
\end{equation}
So the positivity condition is satisfied.

Conversely, suppose $\rho$ is any operator satisfying the two conditions. Because of the positive condition, we have $\rho=\sum_j \lambda_j \ket{j}\bra{j}$, where the vectors $\ket{j}$ are orthogonal, and $\lambda_j$ are real, non-negative eigenvalues of $\rho$. Because of the trace condition, we have $\sum_j \lambda_j=1$. Let $p_i=\lambda_i$, so the probability of each $\ket{j}$ sums up to 1. So $\rho$ is essentially representing an ensemble of states $\{\lambda_j, \ket{j}\}$.
\end{proof}

Also by inspection, if $rank(\rho)=1$, then $\rho$ is a pure state. Otherwise, $\rho$ is mixed.

We therefore are able to describe the four postulates in the language of density matrices. For the complete reformulated postulates, see \textbf{Appendix} \ref{AppendixA}.

% \begin{definition}[Density Matrix]
%  Consider a quantum system with state space $\mathbb{C}^d$. A density matrix, commonly denoted as $\rho$, is a linear operator $\rho \in \mathbb{L}(\mathbb{C}^d, \mathbb{C}^d)$ such that:
%  \begin{enumerate}
%      \item $\rho \geq 0$, and
%      \item $tr(\rho)=1$.
%  \end{enumerate}
 
%  If $rank(\rho)=1$, then $\rho$ is called a pure state, otherwise $\rho$ is mixed.
% \end{definition}

A few theorems that we introduced using state vectors back in Chapter \ref{Chapter3-postulates} can be reformulated using density matrices.
\textbf{Theorem} \ref{theorem: measurement in an orthonormal basis} becomes the following:
\begin{theorem} [Measuring a Density Matrix in an Orthonormal Basis]
Consider a quantum system in the state $\rho$. Measuring $\rho$ in the basis $\{\ket{b_j}\}_j$ results in outcome $j$ with probability $q_j=\braket{b_j | \rho |b_j}$.
\end{theorem}

\bigskip
Under projective measurement defined in section \ref{subsection:projective measurement}, now written in terms of density matrices upon measuring the state $\rho$, the probability of getting result m is given by
\begin{equation}
    p(m)=tr(P_m \rho),
\end{equation}
and the post-measurement states are
\begin{equation}
    \rho_{|m}=\frac{P_m \rho P_m}{tr(P_m \rho)}
\end{equation}
% \begin{definition}[Projective Measurement On Density Matrix] 
% A projective measurement is given by a set of orthogonal projectors $M_x=\Pi_x$ such that $\sum_x \Pi_x=\mathbb{I}$. For such a measurement, unless otherwise specified we will always use the default Kraus decomposition $A_x=\Pi_x$. 

% The probability $q_x$ of observing measurement outcome x can then be expressed as
% \begin{equation}
%     q_x=tr(\Pi_x)
% \end{equation}
% and the post-measurement states are
% \begin{equation}
%     \rho_{\ket{x}}=\frac{\Pi_x \rho \Pi_x}{tr(\Pi_x \rho)}
% \end{equation}

% \end{definition}



% We can simply examine a classical bit to determine whether it is in the state 0 or 1. However, we cannot examine a qubit to determine its quantum state, that is, the value of $\alpha$ and $\beta$. Quantum mechanics tells us that we can only acquire much more restricted information about the quantum state. When we measure a qubit we get either the result 0, with probability $|\alpha|^2$, or the result 1, with probability $|\beta|^2$. Since the probabilities must sum to 1, $|\alpha|^2+|\beta|^2=1$. Thus, a qubit's state is a unit vector in a two-dimensional complex vector space. 

% Measurement changes the state of a qubit, collapsing it from its superposition of $\ket{0}$ and $\ket{1}$ to the specific state consistent with the measurement result.  

\bigskip
Further, the definition of entanglement in definition \ref{definition: entanglement with state vector} becomes 
\begin{definition}[Entanglement]
 Consider two quantum systems A and B and their joint state $\rho_{AB}$. If $\rho_{AB}$.
 
 The joint state $\rho_{AB}$ is separable if there exists a probability distribution $\{p_i\}_i$, and sets of density matrices $\{\rho_i^A\}_i$, $\{\rho_i^B\}_i$ such that $\rho_{AB}=\sum_i p_i\rho_i^A\otimes\rho_i^B$.
 If there exists no such decomposition $\rho_{AB}$ is called entangled.
 If $\rho_{AB}=\ket{\psi}\bra{\psi}$ is a pure state, then $\psi_{AB}$ is separable if and only if there exists $\ket{\psi}_A, \ket{\psi}_B$ such that $\ket{\psi}_{AB}=\ket{\psi}_A \otimes \ket{\psi}_B$.
\end{definition}

\textcolor{red}{for most of what follows, we are only interested in pure states. maybe put the general definition in footnote.}

\textcolor{blue}{The No Cloning Theorem seems a bit out of place here.  Also, do we need this for something later?}
\begin{theorem}[No Cloning Theorem] \label{no-cloning thm}
Arbitrary qubits (or quantum states), unlike classical bits, cannot be copied. 
\end{theorem} 

\begin{proof} \cite{Wehner:notes}
For contradiction, assume there exists such unitary operation C that can copy any arbitrary qubits $\ket{\psi_1}, \ket{\psi_2}$. Then
\begin{equation*}
    C(\ket{\psi_1} \otimes \ket{0})=\ket{\psi_1} \otimes \ket{\psi_1}
\end{equation*}

\begin{equation*}
C(\ket{\psi_2} \otimes \ket{0})=\ket{\psi_2} \otimes \ket{\psi_2}  
\end{equation*}
    

Since C is unitary, we have $C^\dagger C=\mathbb{I}$, so
\begin{eqnarray*}
\braket{\psi_1|\psi_2}&=&\braket{\psi_1|\psi_2}\braket{0|0}\\
&=&(\ket{\psi_1} \otimes \ket{0})(\ket{\psi_2} \otimes \ket{0})\\
&=&(\ket{\psi_1} \otimes \ket{0})C^\dagger C(\ket{\psi_2} \otimes \ket{0})\\
&=&(\bra{\psi_1} \otimes \bra{\psi_1})(\ket{\psi_2} \otimes \ket{\psi_2})\\
&=&(\braket{\psi_1 |\psi_2})^2
\end{eqnarray*}

So $\braket{\psi_1 | \psi_2}=0$ or $1$. So $\ket{\psi_1}$ and $\ket{\psi_2}$ are either equal or othorgonal. So we can only clone states which are orthogonal to one another, but cloning an arbitrary quantum state is impossible. 
\end{proof}