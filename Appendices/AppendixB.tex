% Appendix B

\chapter{More on Density Matrices} % Main appendix title

\label{AppendixB} % For referencing this appendix elsewhere, use \ref{AppendixA}
\section{Postulates of Quantum Mechanics Reformulated with Density Matrices}


% \textcolor{blue}{I THINK EVERYTHING BELOW THIS SHOULD BE IN AN APPENDIX EXCEPT FOR THEOREM 2.  I think this is literally the only thing we use going forward.  I don't think we even use Postulate 3'}

The four Postulates from \textbf{Chapter \ref{Chapter3-postulates}} can be reworked with density matrices in place of state vectors. \textbf{Postulate 1} becomes
\begin{quote}
\textbf{Postulate 1'}: Associated to any isolated physical system is a complex vector space with inner product (that is, a Hilbert space) known as the \textit{state space} of the system. The system is completely described by its \textit{density matrix}, which is a positive matrix with trace one, acting on the state space of the system. If a quantum system is in the state $\rho_i$ with probability $p_i$, then the density matrix for the system is $\sum_i p_i \rho_i$    
\end{quote}

\textcolor{green}{Recall in \textbf{Postulate 2}, we described the evolution of a quantum system. Say the evolution on a quantum system $\rho$ is described a unitary transformation U. Then}
    \begin{equation}
        \rho=\sum_i p_i \ket{\psi_i}\bra{\psi_i}	\underrightarrow{U}\sum_i p_i U \ket{\psi_i}\bra{\psi_i}U^\dagger=U \rho U^\dagger
    \end{equation}
We therefore get \textbf{Postulate 2} reworked for density matrices:  
\begin{quote}
    {\bf{Postulate 2'}}: The evolution of a closed quantum system is described by a \textit{unitary transformation}. That is, the state $\rho$ of the system at time $t_1$ is related to the state $\rho'$ of the system at time $t_2$ by a unitary operator U which depends only on the times $t_1$ and $t_2$,
    \begin{equation} \label{eqn: density matrix postulate 2}
    \rho'=U\rho U^\dagger        
    \end{equation}
\end{quote}

You can check that \eqref{eqn: density matrix postulate 2} is consistent with \textbf{Lemma \ref{lemma state into density}} and {\bf{Postulate 2}} since
\begin{eqnarray}
\ket{U \psi_i}\bra{U \psi_i}&=& \ket{U \psi_i}(\ket{U \psi_i}^\dagger)\\
&=& \ket{U\psi_i}(\ket{\psi_i})^\dagger U^\dagger\\
&=& \ket{U \psi_i} \bra{\psi_i}U^\dagger\\
&=& U \ket{\psi_i}\bra{\psi_i}U^\dagger.
\end{eqnarray}

Similarly, \textbf{Postulate 3} can be translated to density matrices:
\begin{quote}
    \textbf{Postulate 3'}: Quantum measurements are described by a collection $\{M_m\}$ of \textit{measurement operators}. These are operators acting on the state space of the system being measured. The index $m$ refers to the measurement outcomes that may occur in the experiment. If the state of the quantum system is $\ket{\psi}$ immediately before the measurement then the probability that result m occurs is given by 
    \begin{equation}
        p(m)=tr(M_m^\dagger M_m \rho)
    \end{equation}
    and the state of the system after the measurement is
    \begin{equation}
        \frac{M_m \rho M_m^\dagger}{tr(M_m^\dagger M_m \rho)}
    \end{equation}
    The measurement operators satisfy the completeness equation $\sum_m M_m^\dagger M_m =I$
\end{quote}
Here is how we obtain the above reformulation. Suppose we perform a measurement described by measurement operators $M_m$ on an ensemble of pure states $\{p_i, \ket{\psi_i}\}$. If the initial state prepared was $\ket{\psi_i}$, then the probability of outcome $m$ is
    \begin{equation}
        p(m|i)=\braket{\psi_i|M_m^\dagger M_m|\psi_i}=tr(\braket{\psi_i|M_m^\dagger M_m|\psi_i})=tr(M_m^\dagger M_m \ket{\psi_i}\bra{\psi_i})
    \end{equation}
    By \textbf{Postulate 3} in \textbf{Section \ref{section: postulate 3}}, the post-measurement state given the initial state being $\ket{\psi_i}$ is
    \begin{equation}
        \ket{\psi_i^m}=\frac{M_m \ket{\psi_i}}{\sqrt{\bra{\psi_i}M_m^\dagger M_m \ket{\psi_i}}}
    \end{equation}
    and the probability of obtaining result m is
    \begin{equation}
        p(m)=\sum_i p(m|i)p_i=\sum_i p_i tr(M_m^\dagger M_m \ket{\psi_i}\bra{\psi_i})=tr(M_m^\dagger M_m \rho)
    \end{equation}
    The post-measurement state upon result m is an ensemble of states $\ket{\psi_i^m}$ with respective probabilities $p(i|m)$
    \begin{equation}
        \rho_m = \sum_i p(i|m)\ket{\psi_i^m}\bra{\psi_i^m}=\sum_i p(i|m)\frac{M_m \ket{\psi_i}\bra{\psi_i}M_m^\dagger}{\bra{\psi_i}M_m^\dagger M_m \ket{\psi_i}}
    \end{equation}
    By probability theory, we have $p(i|m)=\frac{p(m,i)}{p(m)}=\frac{p(m|i)p_i}{p(m)}$. So
    \begin{equation}
        \rho_m=\sum_i \frac{p(m|i)p_i}{p(m)}\frac{M_m \ket{\psi_i}\bra{\psi_i}M_m^\dagger}{\bra{\psi_i}M_m^\dagger M_m \ket{\psi_i}}=\frac{M_m M_m (\sum_i p_i \ket{\psi_i}\bra{\psi_i})M_m^\dagger}{p(m)}=\frac{M_m \rho M_m^\dagger}{tr(M_m^\dagger M_m \rho)}
    \end{equation}

\bigskip
Under projective measurement defined in \textbf{Appendix \ref{AppendixB}}
, now written in terms of density matrices upon measuring the state $\rho$, the probability of getting result m is given by
\begin{equation}
    p(m)=tr(P_m \rho),
\end{equation}
and the post-measurement states are
\begin{equation}
    \rho_{|m}=\frac{P_m \rho P_m}{tr(P_m \rho)}
\end{equation}

The most commonly used projective measurement, measuring with a basis has already been discussed back in \textbf{Chapter \ref{Chapter4-density matrix}}. Now, we can move on to rewriting \textbf{Postulate 4} into the following:

\bigskip
\begin{quote}
    \textbf{Postulate 4'}:The state space of a composite physical system is the tensor product of the component physical systems. Moreover, if we have systems numbered 1 through n, and system number i is prepared in the state $\rho_i$, then the joint state of the total system is $\rho_1 \otimes \rho_2 \otimes \hdots \otimes \rho_n$
\end{quote}


Further, the definition of entanglement in \textbf{Definition \ref{definition: entanglement with state vector}} becomes 
\begin{definition}[Entanglement] \label{def: entanglement with density matrix}
 Consider two quantum systems A and B and their joint state $\rho_{AB}$. The joint state $\rho_{AB}$ is separable if there exists a probability distribution $\{p_i\}_i$, and sets of density matrices $\{\rho_i^A\}_i$, $\{\rho_i^B\}_i$ such that $\rho_{AB}=\sum_i p_i\rho_i^A\otimes\rho_i^B$.
 If there exists no such decomposition $\rho_{AB}$ is called entangled.
 If $\rho_{AB}=\ket{\psi}\bra{\psi}$ is a pure state, then $\psi_{AB}$ is separable if and only if there exists $\ket{\psi}_A, \ket{\psi}_B$ such that $\ket{\psi}_{AB}=\ket{\psi}_A \otimes \ket{\psi}_B$.
\end{definition}

\section{Reduced Density Matrix}
One very important application of density matrices is the reduced density matrix, a tool to describe sub-systems of a composite quantum system.
\begin{definition}
 Suppose we have a composite system shared by A and B described by $\rho$. The reduced density matrix for A is defined by
\begin{equation}
    \rho^A=tr_B (\rho)
\end{equation}
where $tr_B$ is known as the \textit{partial trace} over system B. The partial trace is defined by
\begin{equation}
tr_B(\ket{a_1}\bra{a_2} \otimes \ket{b_1} \bra{b_2})=\ket{a_1}\bra{a_2}tr(\ket{b_1}\bra{b_2})
\end{equation}
where $\ket{a_1}, \ket{a_2}$ are any two vectors in the state space of A, and $\ket{b_1}, \ket{b_2}$ are two arbitrary vectors in the state space of B.
\end{definition}

{\color{green}
Notice that trace is cyclic, so
\begin{equation}
 tr(\ket{b_1}\bra{b_2})=tr(\braket{b_2|b_1})=\braket{b_2|b_1}
\end{equation}
The partial trace is used to describe part of a larger quantum system because it is actually the \emph{unique} operation that provides the correct measurement statistics (such as the probability distribution) for measurements made on a subsystem. The complete justification can be found in Section 2.4.3 of \cite{Nielsen} 
Let's just illustrate the concept of reduced density matrix and partial trace by the next two examples: one describes a separable state, while the other one describes an entangled state.
\begin{example}
Suppose a joint quantum system of A and B is in state $\rho^{AB}=\rho \otimes \sigma$, where $\rho$ is a density matrix for system A, and $\sigma$ is a density matrix for system B. Then the reduced density matrix for A is
\begin{equation}
    \rho^A=tr_B (\rho \otimes \sigma)=\rho tr(\sigma)=\rho,
\end{equation}
where the last step is true because of \textbf{Theorem \ref{thm: char of density matrix}}.
Similarly $\rho^B=\sigma$.
\end{example}
The above result is consistent with our intuition that for a 
\begin{example}
Now suppose the joint quantum system of A and B is in the entangled state $\ket{EPR}=\frac{1}{\sqrt{2}}(\ket{00}+\ket{11})$. Then the corresponding density matrix is
\begin{eqnarray}
\rho^{AB}&=&\frac{1}{\sqrt{2}}(\ket{00}+\ket{11})\frac{1}{\sqrt{2}}(\bra{00}+\bra{11})\\
&=& \frac{\ket{00}\bra{00}+\ket{11}\bra{11}+\ket{00}\bra{11}+\ket{11}\bra{11}}{2}
\end{eqnarray}
Then the reduced density matrix of system A is 
\begin{eqnarray}
\rho^A&=&tr_B(\rho^{AB})\\
&=&\frac{tr_B(\ket{00}\bra{00})+tr_B(\ket{11}\bra{00})+tr_B(\ket{00}\bra{11})+tr_B(\ket{11}\bra{11})}{2}\\
&=&\frac{\ket{0}\bra{0}\braket{0|0}+\ket{1}\bra{0}\braket{1|0}+\ket{0}\bra{1}\braket{0|1}+\ket{1}\bra{1}\braket{1|1}}{2}\\
&=&\frac{\ket{0}\bra{0}+\ket{1}\bra{1}}{2}\\
&=&\frac{\mathbb{I}}{2}
\end{eqnarray}
The reduced density matrix of system B is $\rho^B=\frac{\mathbb{I}}{2}$
\end{example}
Note that the joint quantum state of A and B is a \emph{pure state} because $rank(\rho^{AB})=1$, but the reduced density matrices on both subsystems are \emph{mixed states}. If it's a mixed state, it is a state that we do not yet have maximal knowledge. That the joint state of a system can be completely known, yet a subsystem be in mixed state is one hallmark of quantum entanglement.
}